# DNA sequence analysis

In this exercise, we will learn how to work with DNA sequence data. We will learn how to use various offline and online bioinformatics software tools. Specifically, we will use the BLAST (Basic Local Alignment Tool) program to compare a DNA sequence that was obtained in previous research with all DNA sequences stored in Genbank. [GenBank](https://www.ncbi.nlm.nih.gov/genbank/) is the NIH genetic sequence database, an annotated collection of all publicly available DNA sequences. GenBank is part of the International Nucleotide Sequence Database Collaboration, which comprises the DNA DataBank of Japan (DDBJ), the European Nucleotide Archive (ENA), and GenBank at NCBI. These three organizations exchange data on a daily basis.

There are several ways to search and retrieve data from GenBank:

1. Search GenBank for sequence identifiers and annotations with Entrez Nucleotide, which is divided into three divisions:
    * CoreNucleotide (the main collection)
    * dbEST (Expressed Sequence Tags)
    * dbGSS (Genome Survey Sequences).
2. Search and align GenBank sequences to a query sequence using BLAST (Basic Local Alignment Search Tool).

We will use BLAST to search te CoreNucleotide main collection.


## BLAST search

1. Copy the following sequence to your clipboard:

>NNNNNNNNNNNTCGCNANNNATAAAAGANGCTTCTTTTTT
ACNTTTAACAAGATTTTTTNTACATGAATATAAAGAAAGGT
CTAAAAATGAAAAATTGATTTATTCTTTTAATAAAAGAAAT
AAATTTGTCACATTTTCTTGGAATTTTTTTTATATTTTTGA
ATTGGAATTTTTTTTAACTTCTCTTTTGACTAGGTTTATAA
ATAATTTAGTTCTATCCAACTTATTCGATCAAATTAATCTA
TTAGAAAAAATAAATAATAATAATAAAAGTCAATATTTTTT
ATCAGAAAAAAGGATCTATAACCAAAATTCCTGTATTCATT
ATGTACGGTATCAAAATCGTTGTATTATGGCTTCGGAAGGC
TTTTATTTTCATGATACGAACTGGATATATTATATATTGAA
TATTTGGCAATTTTTTATGCATTTATGGATTCAACCTTTCA
GGTTCTCAACAAAGCATTTTCAAAAGCAGAGTTTTTTTTTT
CTGGGTTATCAATTTGGCAGAGAATCCAAACTGCTAAAAGT
TCGATCTATTTCACTTGATAAATCACCTACAATTTATTCAC
GTTTAAAAAAAAATATTTTAAAAACACAAATTGTATATCCA
ATAGATTTTCTAGCAAAAGAGGGTTTTTGTGATATTTCAGG
TTATCCTATTAGTAGATCGACTTGGACTACATCGACAGATG
AAGAAATTTTATTGAATTTTAATAAANTTTGGAAAAGCTTT
TATTTTTATTATGGGGGGTTGATAAAAAAAGACATTTTATA
TAGAATCAAATATATCCTCCGATTTTCATGTGCAAAACNCT
AGCTNNNNNNNNNNNNNNNNNNNNNNNNNN

1. Open a web browser on your computer. If you are reading this in your browser, right click on the highlighted link to open the web site of the [U.S. National Library of Medicine](https://www.nlm.nih.gov) in a new tab (Fig. \@ref(fig:nlm)). Otherwise enter the link in your browser manually. 

(ref:nlm) The web page of the U.S. National Library of Medicine.

```{r nlm, fig.cap='(ref:nlm)', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("./figures/bioinformatics/nlm.png")
`````

2. On the U.S. National Library of Medicine web page (Fig. \@ref(fig:nlm)), click on the right most square with the DNA icon and BLAST (Basic Local Alignment Tool) written on it.
3. On the newly opened page (Fig. \@ref(fig:blast)), you will see a row of squares displaying various titles. Click on the left most square that has Nucleotide Blast written on it.

(ref:blast) The Basic Local Alignment Search Tool (BLAST) start page.

```{r blast, fig.cap='(ref:blast)', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("./figures/bioinformatics/blast.png")
`````

4. A new page will open. Paste your DNA sequence into the white box on the top left (Fig. \@ref(fig:sequence)). 

(ref:sequence) Nucleotide BLAST (BLASTN) sequence entry form.

```{r sequence, fig.cap='(ref:sequence)', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("./figures/bioinformatics/sequence_entry.png")
`````

5. Leave the default values unchanged and click on the oval blue button at the lower left that has BLAST written on it (Fig. \@ref(fig:click)). This will upload your sequence (referred to from now on as the **Query** sequence) to the server where it will be compared to all sequences on record. 

```{r click, fig.cap='After you have pasted your sequence into the sequence entry field, click the BLAST button at the lower left of the page.', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("./figures/bioinformatics/click_blast.png")
`````

6. A new page will open that will be updated every 2 seconds while your query is being processed (Fig. \@ref(fig:status)). 

```{r status, fig.cap='The BLASTN query status updated page.', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("./figures/bioinformatics/job_id.png")
`````

7. Once the search has completed, the BLASTN results page will open (Fig. \@ref(fig:results)).

```{r results, fig.cap='The BLASTN results page.', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("./figures/bioinformatics/results.png")
`````

8. Click on the "+" sign in front of "Graphic Summary" (Fig. \@ref(fig:results)). A graphical summary of your results will be shown (Fig. \@ref(fig:graphic). The light green line on top represents your query sequence, below are shown any retreived sequences that align with your sequence.

```{r graphic, fig.cap='Graphic summary of the BLASTN search results.', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("./figures/bioinformatics/graphic_summary.png")
`````

9. Click on the "+" sign in front of "Description" (Fig. \@ref(fig:description)). A list of sequences that align with your query sequence will be shown (Fig. \@ref(fig:description).

```{r description, fig.cap='List of sequences producing significant alignments with your query sequence.', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("./figures/bioinformatics/results_description.png")
`````

10. Click on the first sequence. A new page will showing the alignment of the query sequence with the retrieved sequence (Fig. \@ref(fig:alignment)).

```{r alignment, fig.cap='Alignment of the best retrieved sequence with the query sequence.', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("./figures/bioinformatics/alignment.png")
`````

11. Which sequence matches our query sequence?

13. Is this sequence linked to a scientific publication? If so, download the original paper.

12. What is the scientific name of the organism that has a matching sequence? What is the common English name of this organism? What type of organism is it?

13. What is the name of the gene that matches this sequence? Does the query sequence correspond to a partial or the full-length sequence of this gene?

14. Go back to the list of sequence alignments produced by BLAST. Look for the sequnce with GenBank accession AY348551.1 (accession identifiers are listed in the left most column). Click on it. A new page will open. Towards the top left of the page, just above the title, click on "Send to" (Fig. \@ref(fig:fasta)), in the pop-up, make sure that "Complete Record" is highlighted, and under "Choose Destination", click on "File", then under "Format", choose "Fasta", and then click on "Create File". Save the file for use in the "Design PCR Primers" exercise. 
.

```{r fasta, fig.cap='Save the gene sequence in FASTA format', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("./figures/bioinformatics/save-fasta.png")
`````

14. On which chromosome is this gene located? How many nucleotides does this chromosome have?

14. How many amino acids does the full-lenght gene code for?

14. Find open reading frame (ORF) in the sequence. Write down the nucleotide mumber correspondin to the the beginning of the start codon. Find the stop codon. Write down the number of the last nucleotide of the stop codon. You will need those numbers in the next exercise ("Design of PCR Primers").

15. What is the function of this gene in the organism?
